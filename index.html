<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·ªçc Truy·ªán</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 20px auto;
            padding: 10px;
        }
        select, button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            font-size: 16px;
        }
        #content {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h2>ƒê·ªçc Truy·ªán</h2>
    
    <button onclick="fetchChapters()">üìñ L·∫•y Danh S√°ch Truy·ªán</button>

    <label for="chapterSelect">Ch·ªçn ch∆∞∆°ng:</label>
    <select id="chapterSelect">
        <option value="">Ch∆∞a c√≥ danh s√°ch...</option>
    </select>

    <button onclick="fetchChapter()">üìö Xem Truy·ªán</button>

    <div id="content"></div>

    <script>
        const n8nBaseUrl = "https://n8naws.thanhhai217.com/webhook";

        // H√†m l·∫•y danh s√°ch ch∆∞∆°ng t·ª´ n8n
        async function fetchChapters() {
            try {
                let response = await fetch(`${n8nBaseUrl}/get-chapter-list`);
                let data = await response.json();
                
                let select = document.getElementById("chapterSelect");
                select.innerHTML = "";

                if (data.data.length === 0) {
                    select.innerHTML = '<option value="">Kh√¥ng c√≥ ch∆∞∆°ng n√†o</option>';
                    return;
                }

                data.data.forEach(chapter => {
                    let option = document.createElement("option");
                    option.value = chapter.chapter_no;
                    option.textContent = `Ch∆∞∆°ng ${chapter.chapter_no}: ${chapter.title}`;
                    select.appendChild(option);
                });

                alert("üéâ Danh s√°ch truy·ªán ƒë√£ c·∫≠p nh·∫≠t!");
            } catch (error) {
                console.error("L·ªói l·∫•y danh s√°ch ch∆∞∆°ng:", error);
                alert("‚ùå Kh√¥ng th·ªÉ l·∫•y danh s√°ch truy·ªán. Ki·ªÉm tra k·∫øt n·ªëi!");
            }
        }

        // H√†m l·∫•y n·ªôi dung ch∆∞∆°ng ƒë√£ ch·ªçn
        async function fetchChapter() {
            let chapterNo = document.getElementById("chapterSelect").value;
            if (!chapterNo) return alert("‚ö†Ô∏è Vui l√≤ng ch·ªçn m·ªôt ch∆∞∆°ng!");

            try {
                let response = await fetch(`${n8nBaseUrl}/get-chapter?chapter_no=${chapterNo}`);
                let data = await response.json();
                
                document.getElementById("content").innerHTML = `
                    <h3>üìñ ${data.data.title}</h3>
                    <p>${data.data.content.replace(/\n/g, "<br>")}</p>
                `;
            } catch (error) {
                console.error("L·ªói l·∫•y n·ªôi dung ch∆∞∆°ng:", error);
                alert("‚ùå Kh√¥ng th·ªÉ l·∫•y n·ªôi dung ch∆∞∆°ng!");
            }
        }
    </script>
</body>
</html>
